==7180== NVPROF is profiling process 7180, command: /opt/conda/bin/python3 test_lstm_pytorch_module_jit.py
==7180== Warning: Profiling results might be incorrect with current version of nvcc compiler used to compile cuda app. Compile with nvcc compiler 9.0 or later version to get correct profiling results. Ignore this warning if code is already compiled with the recommended nvcc version 
==7180== Profiling application: /opt/conda/bin/python3 test_lstm_pytorch_module_jit.py
==7180== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   60.88%  516.93us       396  1.3050us  1.2800us  1.6000us  [CUDA memcpy DtoH]
                    6.24%  52.960us         5  10.592us  1.4080us  24.512us  [CUDA memcpy HtoD]
                    3.43%  29.121us         3  9.7070us  9.4410us  10.208us  void kernelReduceAll<double, unsigned int, double, thrust::identity<double>, ReduceMin<double>, int=1>(TensorInfo<double, unsigned int>, unsigned int, double, double, thrust::identity<double>, double*)
                    3.41%  28.928us         3  9.6420us  9.4400us  10.016us  void kernelReduceAll<double, unsigned int, double, thrust::identity<double>, ReduceMax<double>, int=1>(TensorInfo<double, unsigned int>, unsigned int, double, double, thrust::identity<double>, double*)
                    3.03%  25.760us         3  8.5860us  7.4240us  10.752us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__scan::ScanAgent<thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::plus<long>, int, long, thrust::detail::integral_constant<bool, bool=0>>, thrust::device_ptr<long>, thrust::device_ptr<long>, thrust::plus<long>, int, thrust::cuda_cub::cub::ScanTileState<long, bool=1>, thrust::cuda_cub::__scan::AddInitToExclusiveScan<long, thrust::plus<long>>>(thrust::device_ptr<long>, thrust::device_ptr<long>, long, thrust::plus<long>, int, long)
                    2.07%  17.568us         6  2.9280us  2.1440us  4.6400us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_15gpu_kernel_implIZNS0_23gpu_kernel_with_scalarsIZZZNS0_14ne_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE2_clEvEUlffE_EEvS5_RKT_EUlfE0_EEvS5_SB_EUliE_EEviT1_
                    1.97%  16.769us         3  5.5890us  4.8000us  7.1040us  _ZN2at6native18elementwise_kernelILi128ELi4EZNS0_15gpu_kernel_implIZZZNS0_14ne_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE2_clEvEUlffE_EEvS4_RKT_EUliE1_EEviT1_
                    1.76%  14.912us         6  2.4850us  1.9200us  3.7120us  _ZN2at6native18elementwise_kernelILi128ELi4EZNS0_15gpu_kernel_implIZZZNS0_16fill_kernel_cudaERNS_14TensorIteratorEN3c106ScalarEENKUlvE_clEvENKUlvE1_clEvEUlvE_EEvS4_RKT_EUliE2_EEviT1_
                    1.73%  14.688us         3  4.8960us  4.5760us  5.4080us  void kernelReduceAll<bool, unsigned int, long, thrust::identity<long>, ReduceAdd<long>, int=1>(TensorInfo<bool, unsigned int>, unsigned int, long, long, thrust::identity<long>, long*)
                    1.72%  14.592us         3  4.8640us  4.1920us  5.9840us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_15gpu_kernel_implIZZZNS0_14eq_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE2_clEvEUlffE_EEvS4_RKT_EUliE_EEviT1_
                    1.70%  14.464us         2  7.2320us  5.6960us  8.7680us  void gemv2T_kernel_val<int, int, float, float, float, int=128, int=16, int=2, int=2, bool=0, cublasGemvParams<cublasGemvTensor<float const >, cublasGemvTensor<float>, float>>(float const , float, float)
                    1.49%  12.672us         3  4.2240us  3.6800us  5.3120us  _ZN2at6native18elementwise_kernelILi128ELi4EZNS0_15gpu_kernel_implIZNS0_23gpu_kernel_with_scalarsIZZZNS0_14gt_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE1_clEvEUlddE_EEvS5_RKT_EUldE0_EEvS5_SB_EUliE1_EEviT1_
                    1.34%  11.392us         6  1.8980us  1.8560us  2.0160us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_15gpu_kernel_implIZZZNS0_15abs_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE2_clEvEUlfE_EEvS4_RKT_EUliE0_EEviT1_
                    1.16%  9.8560us         1  9.8560us  9.8560us  9.8560us  kernel_0
                    1.16%  9.8240us         3  3.2740us  2.9760us  3.8720us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_15gpu_kernel_implIZZZNS0_21copy_device_to_deviceERNS_14TensorIteratorEbENKUlvE_clEvENKUlvE4_clEvEUllE_EEvS4_RKT_EUliE_EEviT1_
                    1.15%  9.7920us         3  3.2640us  3.0400us  3.6800us  _ZN2at6native18elementwise_kernelILi128ELi4EZNS0_15gpu_kernel_implIZZZNS0_15div_kernel_cudaERNS_14TensorIteratorEENKUlvE0_clEvENKUlvE1_clEvEUlddE_EEvS4_RKT_EUliE2_EEviT1_
                    1.07%  9.1200us         3  3.0400us  2.8160us  3.4880us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_15gpu_kernel_implIZZZNS0_21copy_device_to_deviceERNS_14TensorIteratorEbENKUlvE_clEvENKUlvE1_clEvEUldE_EEvS4_RKT_EUliE_EEviT1_
                    0.96%  8.1290us         3  2.7090us  2.4320us  3.2330us  _ZN2at6native18elementwise_kernelILi128ELi4EZNS0_15gpu_kernel_implIZZZNS0_16ceil_kernel_cudaERNS_14TensorIteratorEENKUlvE_clEvENKUlvE0_clEvEUlfE_EEvS4_RKT_EUliE2_EEviT1_
                    0.82%  6.9760us         3  2.3250us  2.2080us  2.5280us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_15gpu_kernel_implIZNS0_15mul_kernel_cudaERNS_14TensorIteratorEEUlbbE_EEvS4_RKT_EUliE0_EEviT1_
                    0.81%  6.8480us         3  2.2820us  2.1760us  2.4960us  void kernelPointwiseApply3<TensorMaskedSelectOp<float, bool, long>, bool, long, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<bool, bool, long>, OffsetInfo<long, bool, float>, OffsetInfo<TensorMaskedSelectOp<float, bool, long>, bool, unsigned int>, bool, float)
                    0.73%  6.2400us         3  2.0800us  1.4400us  3.2320us  _ZN2at6native18elementwise_kernelILi512ELi1EZNS0_15gpu_kernel_implIZZZNS0_16fill_kernel_cudaERNS_14TensorIteratorEN3c106ScalarEENKUlvE_clEvENKUlvE2_clEvEUlvE_EEvS4_RKT_EUliE0_EEviT1_
                    0.72%  6.1120us         3  2.0370us  1.9200us  2.2400us  void kernelPointwiseApply3<TensorBitAndOp<bool>, bool, bool, bool, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorBitAndOp<bool>, bool, unsigned int>, OffsetInfo<bool, bool, int=1>, OffsetInfo<bool, bool, int=1>, bool, bool)
                    0.64%  5.4400us         3  1.8130us  1.6640us  2.0800us  void thrust::cuda_cub::core::_kernel_agent<thrust::cuda_cub::__scan::InitAgent<thrust::cuda_cub::cub::ScanTileState<long, bool=1>, int>, thrust::cuda_cub::cub::ScanTileState<long, bool=1>, int>(bool=1, thrust::cuda_cub::cub::ScanTileState<long, bool=1>)
      API calls:   89.56%  3.92036s         4  980.09ms  5.6040us  3.91998s  cudaMalloc
                   10.16%  444.96ms         3  148.32ms     817ns  311.20ms  cudaFree
                    0.13%  5.5506ms       400  13.876us  7.6770us  76.695us  cudaMemcpyAsync
                    0.03%  1.1472ms       403  2.8460us  2.2700us  47.022us  cudaStreamSynchronize
                    0.02%  999.37us        68  14.696us  7.4710us  82.622us  cudaLaunchKernel
                    0.02%  982.75us      2461     399ns     277ns  14.586us  cudaGetDevice
                    0.02%  757.79us      1718     441ns     300ns  4.9060us  cudaSetDevice
                    0.01%  645.94us         1  645.94us  645.94us  645.94us  cuModuleLoadData
                    0.01%  586.00us       285  2.0560us     140ns  92.001us  cuDeviceGetAttribute
                    0.01%  585.75us         3  195.25us  185.28us  203.55us  cuDeviceTotalMem
                    0.01%  300.76us         2  150.38us  148.20us  152.55us  cudaGetDeviceProperties
                    0.01%  291.84us         1  291.84us  291.84us  291.84us  cuModuleUnload
                    0.00%  96.014us         3  32.004us  26.788us  38.208us  cuDeviceGetName
                    0.00%  38.782us         6  6.4630us  2.5480us  22.502us  cudaFuncGetAttributes
                    0.00%  23.395us         1  23.395us  23.395us  23.395us  cuLaunchKernel
                    0.00%  20.617us         1  20.617us  20.617us  20.617us  cudaMemcpy
                    0.00%  15.682us        83     188ns     119ns     312ns  cudaGetLastError
                    0.00%  11.205us        23     487ns     289ns  1.4210us  cudaDeviceGetAttribute
                    0.00%  10.731us        16     670ns     475ns  2.6010us  cudaEventCreateWithFlags
                    0.00%  4.5300us         2  2.2650us  1.8830us  2.6470us  cuInit
                    0.00%  4.3940us         1  4.3940us  4.3940us  4.3940us  cuDeviceGetPCIBusId
                    0.00%  4.2830us        16     267ns     155ns     783ns  cudaGetDeviceCount
                    0.00%  2.7210us         5     544ns     177ns  1.5660us  cuDeviceGetCount
                    0.00%  2.0810us        12     173ns     119ns     291ns  cudaPeekAtLastError
                    0.00%  1.8210us         4     455ns     164ns     781ns  cuDeviceGet
                    0.00%  1.2810us         1  1.2810us  1.2810us  1.2810us  cuOccupancyMaxActiveBlocksPerMultiprocessor
                    0.00%  1.2020us         1  1.2020us  1.2020us  1.2020us  cuCtxGetCurrent
                    0.00%     946ns         2     473ns     439ns     507ns  cuDriverGetVersion
                    0.00%     824ns         3     274ns     232ns     331ns  cuDeviceGetUuid
                    0.00%     812ns         1     812ns     812ns     812ns  cuModuleGetFunction
